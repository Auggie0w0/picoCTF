# Malware Detection and Removal Guide

## Malware Scanning Tools

### Install Security Tools

sudo apt install rkhunter chkrootkit clamav lynis

sudo freshclam
sudo rkhunter --update
sudo rkhunter --propupd

### Run System Scans (three options)
sudo clamscan -r --bell -i /
sudo rkhunter --check --sk
sudo chkrootkit

## Backdoor Detection
### Network Connection Check
sudo netstat -tupln
sudo lsof -i

sudo ss -tulpn

### File System Check
sudo find / -type f -name "*.php" -o -name "*.pl" -o -name "*.py" -mtime -7

sudo find / -name ".*" -type f -ls

## Remote Access Tool Detection
### Process Monitoring
ps aux | grep -i "remote\|vnc\|teamviewer"

sudo strace -f -e trace=network -p $(pgrep -d, sshd)

### Service Audit
systemctl list-unit-files | grep enabled

lsmod | head

## Keylogger Detection
### Input Device Monitoring
sudo cat /proc/bus/input/devices

sudo ls -l /dev/input/by-id/

### Process Analysis
ps aux | grep -i "key\|log"

sudo auditctl -w /dev/input/event* -p rw -k keyboard_monitor

## Password Sniffer Detection
### Network Analysis
sudo tcpdump -i any -n port 80 or port 443

sudo tcpdump -i any -n port 80 or port 443

### Memory Analysis
sudo lsmod | grep -i "sniff\|pcap"

## Startup Applications
### System Startup Check
ls -la /etc/init.d/
ls -la /etc/init/
ls -la /etc/systemd/system/

ls -la ~/.config/autostart/
ls -la /etc/xdg/autostart/

### Cron Job Verification
sudo ls -la /etc/cron.*
sudo cat /etc/crontab

for user in $(cut -f1 -d: /etc/passwd); do sudo crontab -u $user -l; done

sudo tail -f /var/log/syslog
sudo tail -f /var/log/auth.log

sudo find / -type f -perm /4000 -ls
sudo find / -type f -perm /2000 -ls

sudo grep -r "CRON" /var/log/
sudo aureport -x --summary

